"use strict";(self["webpackChunkvue2"]=self["webpackChunkvue2"]||[]).push([[892],{2871:function(e,t,a){a.r(t),a.d(t,{default:function(){return $}});var r=a(7314),s=a(3698),i=a(2938),d=a(4414),n=a(3449),l=a(4679),o=a(4162),c=a(9991),u=a(6930),m=a(7683),h=a(2756),b=a(4312),f=a(7150),g=a(1034),p=a(7112),I=function(){var e=this,t=e._self._c;return t(n.A,[t(h.A,[t(d.A,[t(s.A,[t(i.ri,{staticClass:"d-flex justify-space-between align-center"},[e._v(" Students "),t(r.A,{attrs:{color:"primary"},on:{click:e.openDialog}},[t(u.A,{attrs:{left:""}},[e._v("mdi-plus")]),e._v(" Add Student ")],1)],1),t(l.A,{attrs:{headers:e.headers,items:e.students,loading:e.loading,search:e.search},scopedSlots:e._u([{key:"top",fn:function(){return[t(p.A,{staticClass:"mx-4",attrs:{label:"Search","prepend-icon":"mdi-magnify"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]},proxy:!0},{key:"item.actions",fn:function({item:a}){return[t(u.A,{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(a)}}},[e._v(" mdi-pencil ")]),t(u.A,{attrs:{small:""},on:{click:function(t){return e.deleteItem(a)}}},[e._v(" mdi-delete ")])]}}],null,!0)})],1)],1)],1),t(c.A,{attrs:{"max-width":"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[t(s.A,[t(i.ri,[t("span",{staticClass:"headline"},[e._v(e._s(e.formTitle))])]),t(i.OQ,[t(n.A,[t(h.A,[t(d.A,{attrs:{cols:"12"}},[t(p.A,{attrs:{label:"First Name*",rules:[e.rules.required]},model:{value:e.editedItem.firstName,callback:function(t){e.$set(e.editedItem,"firstName",t)},expression:"editedItem.firstName"}})],1),t(d.A,{attrs:{cols:"12"}},[t(p.A,{attrs:{label:"Last Name*",rules:[e.rules.required]},model:{value:e.editedItem.lastName,callback:function(t){e.$set(e.editedItem,"lastName",t)},expression:"editedItem.lastName"}})],1),t(d.A,{attrs:{cols:"12"}},[t(p.A,{attrs:{label:"Middle Name"},model:{value:e.editedItem.middleName,callback:function(t){e.$set(e.editedItem,"middleName",t)},expression:"editedItem.middleName"}})],1),t(d.A,{attrs:{cols:"12"}},[t(m.A,{ref:"menu",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:r}){return[t(p.A,e._g(e._b({attrs:{label:"Birth Date*",readonly:"",rules:[e.rules.required]},model:{value:e.editedItem.birthDate,callback:function(t){e.$set(e.editedItem,"birthDate",t)},expression:"editedItem.birthDate"}},"v-text-field",r,!1),a))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[t(o.A,{on:{input:function(t){e.menu=!1}},model:{value:e.editedItem.birthDate,callback:function(t){e.$set(e.editedItem,"birthDate",t)},expression:"editedItem.birthDate"}})],1)],1),t(d.A,{attrs:{cols:"12"}},[t(b.A,{attrs:{items:e.yearLevels,label:"Year Level*",rules:[e.rules.required]},model:{value:e.editedItem.yearLevel,callback:function(t){e.$set(e.editedItem,"yearLevel",t)},expression:"editedItem.yearLevel"}})],1),t(d.A,{attrs:{cols:"12"}},[t(p.A,{attrs:{label:"Guardian Name"},model:{value:e.editedItem.guardianName,callback:function(t){e.$set(e.editedItem,"guardianName",t)},expression:"editedItem.guardianName"}})],1),t(d.A,{attrs:{cols:"12"}},[t(p.A,{attrs:{label:"Guardian Phone",type:"tel"},model:{value:e.editedItem.guardianPhone,callback:function(t){e.$set(e.editedItem,"guardianPhone",t)},expression:"editedItem.guardianPhone"}})],1),t(d.A,{attrs:{cols:"12"}},[t(b.A,{attrs:{items:e.programs,"item-text":"programAbr","item-value":"_id",label:"Program"},model:{value:e.editedItem.programId,callback:function(t){e.$set(e.editedItem,"programId",t)},expression:"editedItem.programId"}})],1)],1)],1)],1),t(i.SL,[t(g.A),t(r.A,{attrs:{color:"blue darken-1",text:""},on:{click:e.close}},[e._v("Cancel")]),t(r.A,{attrs:{color:"blue darken-1",text:"",loading:e.loading},on:{click:e.save}},[e._v("Save")])],1)],1)],1),t(f.A,{attrs:{color:e.snackbarColor,timeout:3e3},scopedSlots:e._u([{key:"action",fn:function({attrs:a}){return[t(r.A,e._b({attrs:{text:""},on:{click:function(t){e.snackbar=!1}}},"v-btn",a,!1),[e._v("Close")])]}}]),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(" "+e._s(e.snackbarText)+" ")])],1)},v=[],k=(a(4114),a(1250)),x=a(7114),A=a.n(x),N=a(5093),y=a.n(N),w={data:()=>({dialog:!1,menu:!1,search:"",loading:!1,snackbar:!1,snackbarText:"",snackbarColor:"",headers:[{text:"First Name",align:"start",sortable:!0,value:"firstName"},{text:"Last Name",align:"start",sortable:!0,value:"lastName"},{text:"Middle Name",align:"start",sortable:!0,value:"middleName"},{text:"Birth Date",align:"start",sortable:!0,value:"birthDate"},{text:"Year Level",align:"start",sortable:!0,value:"yearLevel"},{text:"Guardian Name",align:"start",sortable:!0,value:"guardianName"},{text:"Guardian Phone",align:"start",sortable:!0,value:"guardianPhone"},{text:"Program",align:"start",sortable:!0,value:"programId.programAbr"},{text:"Actions",value:"actions",sortable:!1}],students:[],editedIndex:-1,editedItem:{firstName:"",lastName:"",middleName:"",birthDate:"",yearLevel:"",guardianName:"",guardianPhone:"",programId:""},defaultItem:{firstName:"",lastName:"",middleName:"",birthDate:"",yearLevel:"",guardianName:"",guardianPhone:"",programId:""},yearLevels:["First Year","Second Year","Third Year","Fourth Year"],programs:[],rules:{required:e=>!!e||"Required."}}),computed:{formTitle(){return-1===this.editedIndex?"New Student":"Edit Student"}},watch:{dialog(e){e||this.close()}},created(){this.fetchStudents(),this.fetchPrograms()},methods:{openDialog(){this.editedIndex=-1,this.editedItem=Object.assign({},this.defaultItem),this.dialog=!0},async fetchStudents(){this.loading=!0;try{const e=await k.A.get(`${A().url}/student`);if(!e.data?.data?.items)throw new Error("Unexpected response structure");this.students=e.data.data.items.map((e=>({...e,birthDate:y()(e.birthDate).format("YYYY-MM-DD")})))}catch(e){console.error("Error fetching students:",e),this.showSnackbar("Error fetching students","error")}finally{this.loading=!1}},async fetchPrograms(){try{const e=await k.A.get(`${A().url}/program`);if(!e.data?.data?.items)throw new Error("Unexpected response structure");this.programs=e.data.data.items}catch(e){console.error("Error fetching programs:",e),this.showSnackbar("Error fetching programs","error")}},editItem(e){this.editedIndex=this.students.indexOf(e),this.editedItem=Object.assign({},e),this.dialog=!0},async deleteItem(e){if(e?._id){if(confirm("Are you sure you want to delete this student?"))try{await k.A.delete(`${A().url}/student/${e._id}`),this.students=this.students.filter((t=>t._id!==e._id)),this.showSnackbar("Student deleted","success")}catch(t){console.error("Error deleting student:",t),this.showSnackbar("Error deleting student","error")}}else this.showSnackbar("Error: Invalid item for deletion","error")},close(){this.dialog=!1,this.$nextTick((()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1}))},async save(){if(this.isValidForm())try{const e={...this.editedItem,birthDate:y()(this.editedItem.birthDate).format("YYYY-MM-DD")};let t;if(t=this.editedIndex>-1?await k.A.put(`${A().url}/student/${e._id}`,e):await k.A.post(`${A().url}/student`,e),!t.data?.data?.item)throw new Error("Unexpected response structure");{const e=t.data.data.item;this.editedIndex>-1?Object.assign(this.students[this.editedIndex],e):this.students.push(e),this.showSnackbar(this.editedIndex>-1?"Student updated":"Student added","success"),this.close()}}catch(e){console.error("Error saving student:",e),this.showSnackbar("Error saving student","error")}else this.showSnackbar("Please fill in all required fields","error")},isValidForm(){return""!==this.editedItem.firstName.trim()&&""!==this.editedItem.lastName.trim()&&""!==this.editedItem.birthDate&&""!==this.editedItem.yearLevel.trim()},showSnackbar(e,t){this.snackbarText=e,this.snackbarColor="error"===t?"red":"green",this.snackbar=!0}}},_=w,S=a(1656),D=(0,S.A)(_,I,v,!1,null,null,null),$=D.exports}}]);
//# sourceMappingURL=892.33634beb.js.map